\documentclass{ximera}

\title{Adding up Pieces: Double Integrals}
\author{Zack Reed}

\begin{document}
\begin{abstract}
In this activity we extend single-variable integration to functions of two variables, exploring double integrals over rectangular and general regions, Fubini's Theorem, and polar coordinates for curved regions.
\end{abstract}
\maketitle

\section*{The Philosophy: Adding Up Pieces}



Throughout calculus, we've developed one powerful idea: \textbf{integration as ``adding up pieces.''} 

What we mean by this is that if we want to find the total value of some quantity $M$, and can break it up into tiny pieces $dM$, then we can sum all those pieces using an integral: $M = \int dM$ ($\int$ can be thought of as ``sum'').

Because of the Fundamental Theorem of Calculus, if $dM$ can be written as a ``rate times a small change'' (like $dM=f(x)dx$), then we can get an easy-to-evaluate formula for $M$ by finding an antiderivative.

Now, we apply similar principles to more complex scenarios, in multiple dimensions.

\begin{problem}
Definite integration allows us to extend simple multiplication to complex scenarios. 

Which of the following are examples where we ``add up pieces''?
\begin{selectAll}
    \choice[correct]{Finding area under a curve by summing rectangular areas $dA=h\cdot dw$}
    \choice[correct]{Computing work when force varies with position using small changes $dW=F\cdot dD$}
    \choice[correct]{Calculating arc length along a curve using small segments $ds=\sqrt{dx^2+dy^2}$}
    \choice{Finding the speed at which an object is moving at a specific time}
    \choice[correct]{Computing volume by stacking cross-sections}
\end{selectAll}

\begin{feedback}
All integral applications follow the same pattern: identify a small piece, express its contribution, then sum its pieces together and take a limit.
\end{feedback}
\end{problem}

\section*{Review: Work and Variable Force}

\begin{problem}
For uniform force, work is a simple product: $W = F \cdot D$. In this example we'll call it ``energy'' instead of work, for ``energy expended''.

But when compressing a spring, the force increases with distance. For example, $F(D) = 55D$ Newtons for a spring with stiffness 55 N/m.

The basic model of multiplication $E = F \cdot D$ \wordChoice{\choice{still works}\choice[correct]{doesn't work}\choice{needs modification}} in a spring context because:
\begin{multipleChoice}
    \choice{The distance is zero}
    \choice[correct]{There's no single force value to use}
    \choice{Energy spent is undefined for springs}
    \choice{The force is negative}
\end{multipleChoice}

Instead, we consider a small distance $dD$. Over this tiny interval, the force is approximately constant at $F(D)$ and the small amount of energy can be well-approximated by $dE = F(D) \cdot dD$.

The following applet shows the basic idea.

%geogebra instructions
\begin{expandable}{stuff}{GeoGebra Instructions}
    Alter the ``Stopping Distance'' slider to change the total distance the spring is compressed, alter the ``View Differential Change Element'' slider to see the small piece of energy $dE$ being added up as we compress the spring along a small distance $dD$.
\end{expandable}

\begin{center}
\geogebra{amcsb2hz}{650}{461}
\end{center}


For the example where the force to hold in a spring at $D$ is given by $F(D)=55D$ Newtons, the small energy needed to move inward a distance $dD$ is: $dE = \answer{55*D} \cdot dD$

Total energy to move in a spring a total distance $X$ is found by: $E = \int_0^{\answer{X}} \answer{55*D}\,dD$

Because of the funamental Theorem of Calculus, and our knowledge that $\frac{dE}{dD} = F(D)$, we know that an antiderivative of $55D$ can be used to efficiently find the value of the integral $\int 55D\,dD$ without needing to compute a limit of Riemann sums.

If $\frac{dE}{dD} = F(D)$, then a formula for $E$ is: $E = \answer{\frac{55D^2}{2}} + C$.

This makes the total energy to compress the spring from 0 to 1 meters: $E = \left[\frac{55D^2}{2}\right]_0^1 = \answer[tolerance=.1]{\frac{55}{2}}$ Joules.

\begin{feedback}
This is ``adding up pieces''! Each piece $dE = F(D)\,dD$ represents energy over an infinitesimal distance, and integration sums all pieces.
\end{feedback}
\end{problem}



\section*{Extension to Multiple Integrals}


The same ``adding up pieces'' philosophy extends to multiple integrals, we simply further break down the ``pieces'' along multiple dimensions.

We'll start by examining hydrostatic force on a dam, in which we can break down the unit of ``area'' $dA$ on the dam not just in the dimension of depth, but also in the dimension of width. This leads us to double integrals.

\begin{problem}
Consider a rectangular dam that is 12 meters deep and 5 meters wide.

\begin{expandable}{stuff}{GeoGebra Instructions}
    Alter the ``Specific Piece of Area'' slider to view different small area regions at various depths. Observe how the force (purple curve) increases with depth.
\end{expandable}

\begin{center}
\geogebra{xebf6ft3}{733}{594}
\end{center}

Why does the force curve bend upward?
\begin{multipleChoice}
    \choice{The width changes}
    \choice[correct]{Pressure increases with depth}
    \choice{The dam is getting weaker}
    \choice{The water density changes}
\end{multipleChoice}


Pressure at depth $D$ is $P(D) = 9800 \cdot D$ (in Pascals). As we go deeper, pressure increases linearly!

\end{problem}

\subsection*{Single-Variable Approach}

\begin{problem}
In the single-variable approach, we noted that since pressure increased with depth only, then small area elements $dA$ could be expressed as ``width times depth'', so we fixed the width at 5 meters and varied only the depth.

So, knowing that $P=9800 \cdot D$, and $dA = 5 \cdot dD$, we can say that a small bit of force $dF$ at depth $D$ is expressed as: $dF = P \cdot dA = P \cdot 5 \cdot dD = \answer{9800 \cdot D \cdot 5} \cdot dD$

The total force with depth up to 12 meters becomes:
$$F = \int_0^{12} 9800 \cdot D \cdot 5 \,dD$$

Using the FTC, we can find an antiderivative of $9800 \cdot D \cdot 5$ to evaluate this integral:
If $\frac{dF}{dD} = 9800 \cdot D \cdot 5$, then $F = \answer{\frac{9800 \cdot D^2 \cdot 5}{2}} + C$.
$$F = \left[\frac{9800 \cdot D^2 \cdot 5}{2}\right]_0^{12} = \answer{3528000} \text{ N}$$

\end{problem}

\subsection*{Double Integral Approach}

\begin{problem}
Now let's incorporate the entire 2D area of the dam using \textbf{two} variables: depth $D$ and width $w$.

The small area element is: $dA = dD \cdot dw$

The pressure at any point $(D,w)$ depends only on depth, but we can still consider pressure to be a two-variable function: $P(D,w) = \answer{9800 \cdot D}$

The small bit of force is:
$$dF = P(A) \cdot dA = \answer{9800 \cdot D} \cdot dD \cdot dw$$

We now have two dimensions of variation to sum over, $w$ and $D$. This will become more formal below, but just as partial derivatives treated off-variables as constants, we can treat off-variables as constants when integrating with respect to one variable at a time.

So we can integrate across the width first, treating depth as constant, then integrate across depth, treating width as constant.

The width of the dam is 5 meters, so we integrate across width from $w=0$ to $w=5$. 

The differential $dF$ is constant with respect to $w$, so our first integral becomes

$$\int_0^5 9800 \cdot D \,dw = 9800 \cdot D \cdot [w]_0^5 = 5\cdot 9800 \cdot D$$

This was exactly the same as our single-variable approach! So we now proceed exactly as before, integrating across depth from $D=0$ to $D=12$: 

$$F=\int_0^{12} 5\cdot 9800 \cdot D \,dD$$

We express the process of integrating in two dimensions as a \textbf{double integral} with the notation $\iint$ to indicate we're summing over a 2D region, and we specify the region of integration $R$ in the subscript:

$$F = \iint_R dF = \int_0^{12}\int_0^5 9800 \cdot D \,dw\,dD$$

\end{problem}

This process of integrating across variables one at a time is called using \textbf{iterated integrals}, and the order of integration can be switched as well. We can't always assume that this is possible, but we have a theorem that gives us conditions for when we can integrate one variable at a time across a multi-dimensional domain: \textbf{Fubini's Theorem}.

\section*{Computing Double Integrals: Fubini's Theorem}

\begin{theorem}[Fubini's Theorem]
For a continuous function $f(x,y)$ over a rectangle $R = [a,b] \times [c,d]$:
$$\iint_R f(x,y)\,dA = \int_a^b \int_c^d f(x,y)\,dy\,dx = \int_c^d \int_a^b f(x,y)\,dx\,dy$$

We can compute double integrals as \textbf{iterated integrals}, evaluating one variable at a time!
\end{theorem}

\begin{problem}
Evaluate $\displaystyle\int_0^2\int_1^3 (x^2 + 2y)\,dy\,dx$.

\textbf{Step 1: Inner integral (with respect to $y$)}
$$\int_1^3 (x^2 + 2y)\,dy = \left[x^2 y + y^2\right]_1^3$$
$$= (x^2 \cdot 3 + 9) - (x^2 \cdot 1 + 1) = \answer{2x^2 + 8}$$

\textbf{Step 2: Outer integral (with respect to $x$)}
$$\int_0^2 (2x^2 + 8)\,dx = \left[\frac{2x^3}{3} + 8x\right]_0^2$$
$$= \frac{16}{3} + 16 = \answer{64/3}$$

\begin{feedback}
Fubini's Theorem lets us break a double integral into two single-variable integrals!
\end{feedback}
\end{problem}

Here's a visual walkthrough of this process.
\begin{center}
\youtube{DkaMXRWhdOg}
\end{center}

\begin{problem}
Now try the other order: $\displaystyle\int_1^3\int_0^2 (x^2 + 2y)\,dx\,dy$.

\textbf{Inner integral (with respect to $x$):}
$$\int_0^2 (x^2 + 2y)\,dx = \left[\frac{x^3}{3} + 2xy\right]_0^2 = \answer{8/3 + 4y}$$

\textbf{Outer integral (with respect to $y$):}
$$\int_1^3 \left(\frac{8}{3} + 4y\right)\,dy = \left[\frac{8y}{3} + 2y^2\right]_1^3$$
$$= \left(\frac{24}{3} + 18\right) - \left(\frac{8}{3} + 2\right) = \answer{64/3}$$

Did you get the same answer? \wordChoice{\choice[correct]{Yes!}\choice{No}}

\begin{feedback}
For rectangular regions, the order of integration doesn't matterâ€”we get the same answer either way!
\end{feedback}
\end{problem}



\end{document}